# Requirements for CUDA 12.8 NVIDIA Hopper (H100/GH200)
# Optimized for scGPT training with flash-attn support
#
# Installation order matters! Run:
#   pip install torch torchvision --index-url https://download.pytorch.org/whl/cu124
#   pip install flash-attn --no-build-isolation
#   pip install -r requirements_cuda12_hopper.txt

# ============================================
# PyTorch & CUDA (install first via command above)
# ============================================
# torch>=2.4.0  # Install separately with CUDA 12.4 wheels
# torchvision>=0.19.0  # Install separately with CUDA 12.4 wheels
torchmetrics>=1.0.0
pytorch-lightning>=2.0.0
lightning-utilities>=0.9.0

# ============================================
# Accelerate & Transformers
# ============================================
accelerate>=0.30.0
transformers>=4.40.0,<4.46.0
safetensors>=0.4.0
tokenizers>=0.19.0
sentencepiece>=0.2.0

# ============================================
# Flash Attention (install separately: pip install flash-attn --no-build-isolation)
# ============================================
# flash-attn>=2.5.0  # Install separately AFTER torch
ninja>=1.11.0
einops>=0.7.0

# ============================================
# scGPT & Single-cell Analysis
# ============================================
scgpt>=0.2.1
anndata>=0.10.0
scanpy>=1.10.0
mudata>=0.3.0
scvi-tools>=1.1.0
scib>=1.1.0
cell-gears>=0.0.2
leidenalg>=0.10.0
igraph>=0.11.0

# ============================================
# Scientific Computing
# ============================================
numpy>=1.24.0,<2.0.0
scipy>=1.11.0
pandas>=2.0.0
scikit-learn>=1.3.0
scikit-misc>=0.3.0
statsmodels>=0.14.0
numba>=0.58.0
llvmlite>=0.41.0

# ============================================
# Data Handling
# ============================================
datasets>=2.18.0
huggingface-hub>=0.23.0
h5py>=3.10.0
zarr>=2.16.0
numcodecs>=0.12.0
pyarrow>=14.0.0
openpyxl>=3.1.0

# ============================================
# Visualization
# ============================================
matplotlib>=3.8.0
seaborn>=0.13.0
pillow>=10.0.0

# ============================================
# Probabilistic Programming
# ============================================
pyro-ppl>=1.9.0
pyro-api>=0.1.2
numpyro>=0.14.0

# ============================================
# Dimensionality Reduction
# ============================================
umap-learn>=0.5.5
pynndescent>=0.5.10

# ============================================
# Utilities
# ============================================
tqdm>=4.66.0
pyyaml>=6.0.0
python-dotenv>=1.0.0
click>=8.1.0
requests>=2.31.0
filelock>=3.13.0
fsspec>=2024.2.0
joblib>=1.3.0
regex>=2023.0.0

# ============================================
# Configuration & Logging
# ============================================
ml_collections>=0.1.1
absl-py>=2.0.0
rich>=13.0.0

# ============================================
# Other Dependencies
# ============================================
Jinja2>=3.1.0
networkx>=3.2.0
packaging>=23.0
typing_extensions>=4.9.0
attrs>=23.0.0
six>=1.16.0
python-dateutil>=2.8.0
nest-asyncio>=1.6.0
dill>=0.3.7
multiprocess>=0.70.15
protobuf>=4.25.0
wrapt>=1.16.0
toolz>=0.12.0
opt_einsum>=3.3.0

# ============================================
# NOTE: torchtext is DEPRECATED and removed
# scGPT doesn't actually need it for training
# ============================================
