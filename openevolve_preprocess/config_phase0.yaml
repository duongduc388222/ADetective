# OpenEvolve Configuration - Phase 0: Meta-Prompt Evolution
#
# This phase evolves PROMPT CONFIGURATIONS that guide code generation.
# The evolved prompts will be used in Phase 1 and Phase 2.
#
# What gets evolved:
#   - system_message: Instructions for code generation
#   - template_variations: Stochastic variation options
#
# Usage:
#   openevolve prompts/baseline_prompt_config.yaml prompt_evaluator.py \
#     --config config_phase0.yaml \
#     --iterations 30 \
#     --output ./output/phase0_results

# Evolution settings
max_iterations: 30
random_seed: 42

# LLM Configuration
llm:
  api_base: "https://generativelanguage.googleapis.com/v1beta/openai/"
  models:
    - name: "gemini-2.5-flash"
      weight: 1.0
  temperature: 0.7   # Higher temperature for prompt creativity
  max_tokens: 4000

# Meta-prompt configuration for evolving prompt configs
prompt:
  num_top_programs: 3
  num_diverse_programs: 2
  include_artifacts: true
  system_message: |
    You are a prompt engineering expert specializing in bioinformatics and machine learning.

    Your task is to evolve a YAML prompt configuration that will guide an LLM to generate
    optimal preprocessing code for single-cell RNA-seq data. The code will prepare data
    for the CellFM foundation model for Alzheimer's Disease classification.

    ## WHAT YOU ARE EVOLVING

    You are evolving a YAML configuration with:
    1. system_message: Instructions that tell the LLM how to write preprocessing code
    2. template_variations: Stochastic variations that add diversity to the prompt
    3. Configuration parameters (num_top_programs, num_diverse_programs, etc.)

    ## TEMPLATE VARIATIONS

    Placeholders like {task_framing}, {strategy_emphasis}, {feedback_style} in the
    system_message are replaced with random selections from template_variations.

    Example: If template_variations.task_framing has 3 options, each code generation
    randomly picks one, adding diversity.

    ## DOMAIN KNOWLEDGE

    Include these concepts in your evolved prompt:
    - scRNA-seq data is sparse (80-95% zeros)
    - CellFM requires 27,934 genes (genemap aligned)
    - Log-normalized values should be in range 0-15
    - Oligodendrocytes for AD classification (4 classes)

    ## EVOLUTION STRATEGIES

    Based on evaluation feedback:
    - Low stats_score: Add explicit output format constraints
    - Low model_score: Adjust HVG/normalization guidance
    - Both low: Simplify the prompt

    ## OUTPUT FORMAT

    Return ONLY valid YAML starting with "prompt:" containing:
    - system_message (with {placeholders})
    - template_variations (matching placeholders)
    - num_top_programs, num_diverse_programs, include_artifacts, use_template_stochasticity

    Keep system_message under 2000 characters.

# Population database settings
database:
  population_size: 30
  num_islands: 3
  migration_interval: 8
  feature_dimensions:
    - "prompt_complexity"
    - "variation_diversity"
  feature_bins: 5

# Evaluator settings
evaluator:
  cascade_evaluation: true
  cascade_thresholds:
    - 0.2   # Stage 1 threshold (code generation success)
